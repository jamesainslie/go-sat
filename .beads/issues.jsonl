{"id":"sat-0ai","title":"Fix: Incorrect unk token score lookup in Viterbi fallback","description":"## Location\n/Volumes/Development/go-sat/tokenizer/unigram.go:70\n\n## Issue\nThe Viterbi algorithm fallback uses `t.unkID` (which is 3, the HuggingFace ID) as an index into `t.idToPiece` (which is indexed by SentencePiece index). The unknown token `\u003cunk\u003e` is at SentencePiece index 0, not 3.\n\n## Current Code\n```go\nbest[i] = best[i-1] + float64(t.scores[t.idToPiece[t.unkID]])\n```\n\n## Recommended Fix\n```go\nunkSPIndex := t.hfIDToSPIndex(t.unkID) // returns 0\nbest[i] = best[i-1] + float64(t.scores[t.idToPiece[unkSPIndex]])\n```\n\n## Impact\nViterbi scoring is incorrect for OOV character fallbacks, potentially producing suboptimal tokenizations.","status":"closed","priority":2,"issue_type":"bug","owner":"42301770+jamesainslie@users.noreply.github.com","created_at":"2026-01-19T11:48:41.567543-05:00","created_by":"James Ainslie","updated_at":"2026-01-19T12:05:01.841923-05:00","closed_at":"2026-01-19T12:05:01.841923-05:00","close_reason":"Fixed by converting HF ID to SentencePiece index before lookup in Viterbi fallback"}
{"id":"sat-0vu","title":"Task 0: Project Setup","status":"closed","priority":2,"issue_type":"task","owner":"42301770+jamesainslie@users.noreply.github.com","created_at":"2026-01-19T08:41:11.545675-05:00","created_by":"James Ainslie","updated_at":"2026-01-19T08:47:07.427607-05:00","closed_at":"2026-01-19T08:47:07.427607-05:00","close_reason":"Completed: project setup with go.mod, dependencies, testdata, golden files"}
{"id":"sat-2ox","title":"Task 4: Unigram Viterbi Algorithm","status":"closed","priority":2,"issue_type":"task","owner":"42301770+jamesainslie@users.noreply.github.com","created_at":"2026-01-19T08:41:21.391774-05:00","created_by":"James Ainslie","updated_at":"2026-01-19T09:02:50.368062-05:00","closed_at":"2026-01-19T09:02:50.368062-05:00","close_reason":"Completed: Viterbi DP encoding algorithm"}
{"id":"sat-5r1","title":"Task 3: Text Normalization","status":"closed","priority":2,"issue_type":"task","owner":"42301770+jamesainslie@users.noreply.github.com","created_at":"2026-01-19T08:41:21.205174-05:00","created_by":"James Ainslie","updated_at":"2026-01-19T09:00:18.418585-05:00","closed_at":"2026-01-19T09:00:18.418585-05:00","close_reason":"Completed: text normalization with ‚ñÅ prefix"}
{"id":"sat-7kg","title":"Fix: errcheck failure in CLI seg.Close()","description":"golangci-lint errcheck reports unchecked error on line 38 of cmd/sat-cli/main.go.\n\nFile: cmd/sat-cli/main.go:38\nCurrent: defer seg.Close()\nFix: Use deferred closure that logs the error\n\nThis is blocking CI lint checks.","status":"closed","priority":1,"issue_type":"bug","owner":"42301770+jamesainslie@users.noreply.github.com","created_at":"2026-01-19T09:34:58.849108-05:00","created_by":"James Ainslie","updated_at":"2026-01-19T09:35:32.385586-05:00","closed_at":"2026-01-19T09:35:32.385586-05:00","close_reason":"Fixed errcheck in CLI defer"}
{"id":"sat-85t","title":"Task 12: Documentation","status":"closed","priority":2,"issue_type":"task","owner":"42301770+jamesainslie@users.noreply.github.com","created_at":"2026-01-19T08:41:22.842954-05:00","created_by":"James Ainslie","updated_at":"2026-01-19T09:33:38.74393-05:00","closed_at":"2026-01-19T09:33:38.74393-05:00","close_reason":"Package documentation and README created"}
{"id":"sat-bcq","title":"Refactor: Add t.Run subtests to normalize_test.go","description":"## Location\n/Volumes/Development/go-sat/tokenizer/normalize_test.go:18-23\n\n## Issue\nThe table-driven test in `TestNormalize` does not use `t.Run()` for subtests, which:\n- Makes it harder to identify which case failed\n- Prevents parallel test execution\n- Is inconsistent with `tokenizer_test.go` which properly uses `t.Run()`\n\n## Current Code\n```go\nfor _, tc := range tests {\n    got := normalize(tc.input)\n    if got != tc.expected {\n        t.Errorf(...)\n    }\n}\n```\n\n## Recommended Fix\n```go\nfor _, tc := range tests {\n    t.Run(tc.input, func(t *testing.T) {\n        got := normalize(tc.input)\n        if got != tc.expected {\n            t.Errorf(...)\n        }\n    })\n}\n```","status":"closed","priority":3,"issue_type":"task","owner":"42301770+jamesainslie@users.noreply.github.com","created_at":"2026-01-19T11:48:42.614557-05:00","created_by":"James Ainslie","updated_at":"2026-01-19T12:36:25.337391-05:00","closed_at":"2026-01-19T12:36:25.337391-05:00","close_reason":"Added t.Run subtests with descriptive test names"}
{"id":"sat-bwq","title":"Task 8: Session Pool","status":"closed","priority":2,"issue_type":"task","owner":"42301770+jamesainslie@users.noreply.github.com","created_at":"2026-01-19T08:41:22.074666-05:00","created_by":"James Ainslie","updated_at":"2026-01-19T09:25:28.488639-05:00","closed_at":"2026-01-19T09:25:28.488639-05:00","close_reason":"Session pool implemented with channel-based pooling, context cancellation, proper cleanup"}
{"id":"sat-cut","title":"Refactor: Pool.Close() should aggregate all session close errors","description":"File: inference/pool.go:91-97\n\nCurrent implementation only returns the last error if multiple sessions fail to close. Should use errors.Join() to aggregate all errors, matching the pattern already used in sat.go:Close().\n\nThis improves debugging when multiple session cleanups fail.","status":"closed","priority":2,"issue_type":"task","owner":"42301770+jamesainslie@users.noreply.github.com","created_at":"2026-01-19T09:35:03.300871-05:00","created_by":"James Ainslie","updated_at":"2026-01-19T12:36:25.740708-05:00","closed_at":"2026-01-19T12:36:25.740708-05:00","close_reason":"Changed Pool.Close to use errors.Join for aggregating all session close errors"}
{"id":"sat-e40","title":"Refactor: Add sentinel errors for session/pool closed states","description":"## Summary\n\nThe inference package uses `fmt.Errorf()` to create error messages for closed session/pool states. These should be sentinel errors to allow callers to programmatically handle these conditions with `errors.Is()`.\n\n## Files Affected\n\n- `/Volumes/Development/go-sat/inference/session.go:81`\n- `/Volumes/Development/go-sat/inference/pool.go:50`\n\n## Current Code\n\n```go\n// session.go:81\nreturn nil, fmt.Errorf(\"session is closed\")\n\n// pool.go:50\nreturn nil, fmt.Errorf(\"pool is closed\")\n```\n\n## Recommended Fix\n\n```go\n// Add at package level:\nvar (\n    ErrSessionClosed = errors.New(\"session is closed\")\n    ErrPoolClosed    = errors.New(\"pool is closed\")\n)\n\n// Then use:\nreturn nil, ErrSessionClosed\nreturn nil, ErrPoolClosed\n```\n\n## Why This Matters\n\nSentinel errors allow callers to use `errors.Is()` for programmatic error handling, following Dave Cheney's error handling best practices. This is especially useful for retry logic or graceful degradation patterns.\n\n## Priority\n\nP2 - Enhancement, not a bug. Current code works correctly.","status":"closed","priority":2,"issue_type":"task","owner":"42301770+jamesainslie@users.noreply.github.com","created_at":"2026-01-19T11:48:32.817051-05:00","created_by":"James Ainslie","updated_at":"2026-01-19T12:36:25.558401-05:00","closed_at":"2026-01-19T12:36:25.558401-05:00","close_reason":"Added ErrSessionClosed and ErrPoolClosed sentinel errors"}
{"id":"sat-gw2","title":"Task 7: ONNX Session Wrapper","status":"closed","priority":2,"issue_type":"task","owner":"42301770+jamesainslie@users.noreply.github.com","created_at":"2026-01-19T08:41:21.890138-05:00","created_by":"James Ainslie","updated_at":"2026-01-19T09:20:41.191545-05:00","closed_at":"2026-01-19T09:20:41.191545-05:00","close_reason":"ONNX session wrapper implemented with thread safety, context handling, proper cleanup"}
{"id":"sat-htb","title":"Task 10: Segmenter Core Implementation","status":"closed","priority":2,"issue_type":"task","owner":"42301770+jamesainslie@users.noreply.github.com","created_at":"2026-01-19T08:41:22.470286-05:00","created_by":"James Ainslie","updated_at":"2026-01-19T09:31:11.230994-05:00","closed_at":"2026-01-19T09:31:11.230994-05:00","close_reason":"Segmenter API implemented with New, IsComplete, Segment, Close, proper error wrapping"}
{"id":"sat-jon","title":"Task 2: Tokenizer Core Structure","status":"closed","priority":2,"issue_type":"task","owner":"42301770+jamesainslie@users.noreply.github.com","created_at":"2026-01-19T08:41:20.948704-05:00","created_by":"James Ainslie","updated_at":"2026-01-19T08:57:17.332898-05:00","closed_at":"2026-01-19T08:57:17.332898-05:00","close_reason":"Completed: Tokenizer core structure with vocab maps"}
{"id":"sat-kzk","title":"Task 11: CLI Tool","status":"closed","priority":2,"issue_type":"task","owner":"42301770+jamesainslie@users.noreply.github.com","created_at":"2026-01-19T08:41:22.659416-05:00","created_by":"James Ainslie","updated_at":"2026-01-19T09:32:34.881614-05:00","closed_at":"2026-01-19T09:32:34.881614-05:00","close_reason":"CLI tool implemented with complete and segment modes"}
{"id":"sat-ozj","title":"Task 5: Golden File Validation","status":"closed","priority":2,"issue_type":"task","owner":"42301770+jamesainslie@users.noreply.github.com","created_at":"2026-01-19T08:41:21.541053-05:00","created_by":"James Ainslie","updated_at":"2026-01-19T09:07:33.329699-05:00","closed_at":"2026-01-19T09:07:33.329699-05:00","close_reason":"Completed: golden file validation - all 11 test cases pass"}
{"id":"sat-qzn","title":"Task 6: Decode Implementation","status":"closed","priority":2,"issue_type":"task","owner":"42301770+jamesainslie@users.noreply.github.com","created_at":"2026-01-19T08:41:21.700328-05:00","created_by":"James Ainslie","updated_at":"2026-01-19T09:13:40.558785-05:00","closed_at":"2026-01-19T09:13:40.558785-05:00","close_reason":"Decode method implemented with HF ID conversion, tests pass, code review approved"}
{"id":"sat-t3u","title":"Refactor: Add golangci-lint v2 configuration","description":"Project lacks .golangci.yml configuration file.\n\nAdd v2 configuration to:\n- Document which linters are enabled\n- Ensure consistent linting across CI and local development\n- Enable additional useful linters (gocritic, gocognit, etc.)\n\nReference: Use standard v2 format with linters.settings and linters.exclusions structure.","status":"open","priority":2,"issue_type":"task","owner":"42301770+jamesainslie@users.noreply.github.com","created_at":"2026-01-19T09:35:05.516236-05:00","created_by":"James Ainslie","updated_at":"2026-01-19T09:35:05.516236-05:00"}
{"id":"sat-y98","title":"Task 9: Segmenter Errors and Options","status":"closed","priority":2,"issue_type":"task","owner":"42301770+jamesainslie@users.noreply.github.com","created_at":"2026-01-19T08:41:22.268138-05:00","created_by":"James Ainslie","updated_at":"2026-01-19T09:26:31.543001-05:00","closed_at":"2026-01-19T09:26:31.543001-05:00","close_reason":"Sentinel errors and functional options pattern implemented"}
{"id":"sat-yic","title":"Implement benchmark suite for threshold tuning","description":"Implement sat-bench CLI for measuring sentence boundary detection accuracy.\n\nDesign: docs/plans/2026-01-19-benchmark-suite-design.md\n\nDeliverables:\n- cmd/sat-bench/main.go\n- internal/bench/corpus.go\n- internal/bench/metrics.go  \n- internal/bench/sweep.go\n- testdata/ted/*.txt (6 TED Talk transcripts)","status":"open","priority":2,"issue_type":"feature","owner":"42301770+jamesainslie@users.noreply.github.com","created_at":"2026-01-19T12:59:56.047322-05:00","created_by":"James Ainslie","updated_at":"2026-01-19T13:00:02.550077-05:00"}
{"id":"sat-zpu","title":"Task 1: Protobuf Model Loading","status":"closed","priority":2,"issue_type":"task","owner":"42301770+jamesainslie@users.noreply.github.com","created_at":"2026-01-19T08:41:20.738115-05:00","created_by":"James Ainslie","updated_at":"2026-01-19T08:53:47.159747-05:00","closed_at":"2026-01-19T08:53:47.159747-05:00","close_reason":"Completed: protobuf schema and LoadModel function"}
